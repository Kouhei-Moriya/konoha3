#!/bin/bash
# generated by kimio

GLOBALSCORE=0
GLOBALMAX=0

OUTFILE=ckonoha

if [ -f "${OUTFILE}.txt" ] ; then
	rm -rf "${OUTFILE}.txt"
fi

if [ -f "${OUTFILE}.csv" ] ; then
	rm -rf "${OUTFILE}.csv"
fi

function run_test { # count max profile options, file
	echo -n "[$1/$2] running test $4 $5 .."
	KONOHA_TESTPROFILE=$3 minikonoha $4 $5 > /dev/null
	result=$?
	#echo $result
	if [ $result -eq 0 ] ; then
		echo "[PASS]"
		PASS=$(($PASS + 1))
	else
		echo "[FAILED]"
		echo "## [FAILED] $4 $5" >> "${OUTFILE}.txt"
		cat $5 >> "${OUTFILE}.txt"
		echo "RESULT:" >> "${OUTFILE}.txt"
		KONOHA_TESTPROFILE=$3 minikonoha $4 $5 >> "${OUTFILE}.txt"
		if [ $result -eq 78 ] ; then
			echo "diff $5.$3_proof $5.$3_tested" >> "${OUTFILE}.txt"
			diff $5.$3_proof $5.$3_tested >> "${OUTFILE}.txt"
		fi
		echo >> "${OUTFILE}.txt"
	fi
}

function record_result { # test, count, max
	GLOBALSCORE=$(($GLOBALSCORE + $2))
	GLOBALMAX=$(($GLOBALMAX + $3))
	per=$(($2 * 100 / $3))
	echo "(TEST $1) [$2/$3, $per%]"
	echo "$1, $2, $3" >> "${OUTFILE}.csv"
}

function total {
	per=$(($GLOBALSCORE * 100 / $GLOBALMAX))
	echo "((TOTAL)) [$GLOBALSCORE/$GLOBALMAX, $per%]"
	echo "MORE INFO: ${OUTFILE}.csv ${OUTFILE}.txt"
}

## 0001_Assertion
PASS=0
run_test 1 8 standard "-MOutputTest" 0001_Assertion/Assertion_False.k
run_test 2 8 standard "-MOutputTest" 0001_Assertion/Assertion_TopLevelFalse.k
run_test 3 8 standard "-MOutputTest" 0001_Assertion/Assertion_TopLevelTrue.k
run_test 4 8 standard "-MOutputTest" 0001_Assertion/Assertion_True.k
run_test 5 8 cstyle "-MOutputTest -Icstyle" 0001_Assertion/Assertion_False.k
run_test 6 8 cstyle "-MOutputTest -Icstyle" 0001_Assertion/Assertion_TopLevelFalse.k
run_test 7 8 cstyle "-MOutputTest -Icstyle" 0001_Assertion/Assertion_TopLevelTrue.k
run_test 8 8 cstyle "-MOutputTest -Icstyle" 0001_Assertion/Assertion_True.k
record_result 0001_Assertion $PASS 8
## 0002_SystemPrint
PASS=0
run_test 1 12 standard "-MOutputTest" 0002_SystemPrint/SystemPrint_HelloWorld.k
run_test 2 12 standard "-MOutputTest" 0002_SystemPrint/SystemPrint_Integer.k
run_test 3 12 standard "-MOutputTest" 0002_SystemPrint/SystemPrint_Number.k
run_test 4 12 standard "-MOutputTest" 0002_SystemPrint/SystemPrint_TopLevel.k
run_test 5 12 standard "-MOutputTest" 0002_SystemPrint/SystemPrint_Variable.k
run_test 6 12 standard "-MOutputTest" 0002_SystemPrint/SystemPrint_VariableInt.k
run_test 7 12 cstyle "-MOutputTest -Icstyle" 0002_SystemPrint/SystemPrint_HelloWorld.k
run_test 8 12 cstyle "-MOutputTest -Icstyle" 0002_SystemPrint/SystemPrint_Integer.k
run_test 9 12 cstyle "-MOutputTest -Icstyle" 0002_SystemPrint/SystemPrint_Number.k
run_test 10 12 cstyle "-MOutputTest -Icstyle" 0002_SystemPrint/SystemPrint_TopLevel.k
run_test 11 12 cstyle "-MOutputTest -Icstyle" 0002_SystemPrint/SystemPrint_Variable.k
run_test 12 12 cstyle "-MOutputTest -Icstyle" 0002_SystemPrint/SystemPrint_VariableInt.k
record_result 0002_SystemPrint $PASS 12
## 0003_FuncDeclVoid
PASS=0
run_test 1 62 minimum "-MOutputTest" 0003_FuncDeclVoid/FuncDeclVoid_Unbox01.k
run_test 2 62 minimum "-MOutputTest" 0003_FuncDeclVoid/FuncDeclVoid_Unbox02.k
run_test 3 62 minimum "-MOutputTest" 0003_FuncDeclVoid/FuncDeclVoid_Unbox03.k
run_test 4 62 minimum "-MOutputTest" 0003_FuncDeclVoid/FuncDeclVoid_Unbox04.k
run_test 5 62 minimum "-MOutputTest" 0003_FuncDeclVoid/FuncDeclVoid_Unbox05.k
run_test 6 62 minimum "-MOutputTest" 0003_FuncDeclVoid/FuncDeclVoid_Unbox06.k
run_test 7 62 minimum "-MOutputTest" 0003_FuncDeclVoid/FuncDeclVoid_Unbox07.k
run_test 8 62 minimum "-MOutputTest" 0003_FuncDeclVoid/FuncDeclVoid_Unbox08.k
run_test 9 62 minimum "-MOutputTest" 0003_FuncDeclVoid/FuncDeclVoid_Unbox09.k
run_test 10 62 minimum "-MOutputTest" 0003_FuncDeclVoid/FuncDeclVoid_Unbox10.k
run_test 11 62 minimum "-MOutputTest" 0003_FuncDeclVoid/FuncDeclVoid_Unbox11.k
run_test 12 62 minimum "-MOutputTest" 0003_FuncDeclVoid/FuncDeclVoid_Unbox12.k
run_test 13 62 minimum "-MOutputTest" 0003_FuncDeclVoid/FuncDeclVoid_Unbox13.k
run_test 14 62 minimum "-MOutputTest" 0003_FuncDeclVoid/FuncDeclVoid_Unbox14.k
run_test 15 62 minimum "-MOutputTest" 0003_FuncDeclVoid/FuncDeclVoid_Unbox15.k
run_test 16 62 minimum "-MOutputTest" 0003_FuncDeclVoid/FuncDeclVoid_Unbox16.k
run_test 17 62 minimum "-MOutputTest" 0003_FuncDeclVoid/FuncDeclVoid_Unbox17.k
run_test 18 62 minimum "-MOutputTest" 0003_FuncDeclVoid/FuncDeclVoid_Unbox18.k
run_test 19 62 minimum "-MOutputTest" 0003_FuncDeclVoid/FuncDeclVoid_Unbox19.k
run_test 20 62 minimum "-MOutputTest" 0003_FuncDeclVoid/FuncDeclVoid_Unbox20.k
run_test 21 62 minimum "-MOutputTest" 0003_FuncDeclVoid/FuncDeclVoid_Unbox21.k
run_test 22 62 minimum "-MOutputTest" 0003_FuncDeclVoid/FuncDeclVoid_Unbox22.k
run_test 23 62 minimum "-MOutputTest" 0003_FuncDeclVoid/FuncDeclVoid_Unbox23.k
run_test 24 62 minimum "-MOutputTest" 0003_FuncDeclVoid/FuncDeclVoid_Unbox24.k
run_test 25 62 minimum "-MOutputTest" 0003_FuncDeclVoid/FuncDeclVoid_Unbox25.k
run_test 26 62 minimum "-MOutputTest" 0003_FuncDeclVoid/FuncDeclVoid_Unbox26.k
run_test 27 62 minimum "-MOutputTest" 0003_FuncDeclVoid/FuncDeclVoid_Unbox27.k
run_test 28 62 minimum "-MOutputTest" 0003_FuncDeclVoid/FuncDeclVoid_Unbox28.k
run_test 29 62 minimum "-MOutputTest" 0003_FuncDeclVoid/FuncDeclVoid_Unbox29.k
run_test 30 62 minimum "-MOutputTest" 0003_FuncDeclVoid/FuncDeclVoid_UnboxOverload30.k
run_test 31 62 minimum "-MOutputTest" 0003_FuncDeclVoid/FuncDeclVoid_Void.k
run_test 32 62 cstyle "-MOutputTest -Icstyle" 0003_FuncDeclVoid/FuncDeclVoid_Unbox01.k
run_test 33 62 cstyle "-MOutputTest -Icstyle" 0003_FuncDeclVoid/FuncDeclVoid_Unbox02.k
run_test 34 62 cstyle "-MOutputTest -Icstyle" 0003_FuncDeclVoid/FuncDeclVoid_Unbox03.k
run_test 35 62 cstyle "-MOutputTest -Icstyle" 0003_FuncDeclVoid/FuncDeclVoid_Unbox04.k
run_test 36 62 cstyle "-MOutputTest -Icstyle" 0003_FuncDeclVoid/FuncDeclVoid_Unbox05.k
run_test 37 62 cstyle "-MOutputTest -Icstyle" 0003_FuncDeclVoid/FuncDeclVoid_Unbox06.k
run_test 38 62 cstyle "-MOutputTest -Icstyle" 0003_FuncDeclVoid/FuncDeclVoid_Unbox07.k
run_test 39 62 cstyle "-MOutputTest -Icstyle" 0003_FuncDeclVoid/FuncDeclVoid_Unbox08.k
run_test 40 62 cstyle "-MOutputTest -Icstyle" 0003_FuncDeclVoid/FuncDeclVoid_Unbox09.k
run_test 41 62 cstyle "-MOutputTest -Icstyle" 0003_FuncDeclVoid/FuncDeclVoid_Unbox10.k
run_test 42 62 cstyle "-MOutputTest -Icstyle" 0003_FuncDeclVoid/FuncDeclVoid_Unbox11.k
run_test 43 62 cstyle "-MOutputTest -Icstyle" 0003_FuncDeclVoid/FuncDeclVoid_Unbox12.k
run_test 44 62 cstyle "-MOutputTest -Icstyle" 0003_FuncDeclVoid/FuncDeclVoid_Unbox13.k
run_test 45 62 cstyle "-MOutputTest -Icstyle" 0003_FuncDeclVoid/FuncDeclVoid_Unbox14.k
run_test 46 62 cstyle "-MOutputTest -Icstyle" 0003_FuncDeclVoid/FuncDeclVoid_Unbox15.k
run_test 47 62 cstyle "-MOutputTest -Icstyle" 0003_FuncDeclVoid/FuncDeclVoid_Unbox16.k
run_test 48 62 cstyle "-MOutputTest -Icstyle" 0003_FuncDeclVoid/FuncDeclVoid_Unbox17.k
run_test 49 62 cstyle "-MOutputTest -Icstyle" 0003_FuncDeclVoid/FuncDeclVoid_Unbox18.k
run_test 50 62 cstyle "-MOutputTest -Icstyle" 0003_FuncDeclVoid/FuncDeclVoid_Unbox19.k
run_test 51 62 cstyle "-MOutputTest -Icstyle" 0003_FuncDeclVoid/FuncDeclVoid_Unbox20.k
run_test 52 62 cstyle "-MOutputTest -Icstyle" 0003_FuncDeclVoid/FuncDeclVoid_Unbox21.k
run_test 53 62 cstyle "-MOutputTest -Icstyle" 0003_FuncDeclVoid/FuncDeclVoid_Unbox22.k
run_test 54 62 cstyle "-MOutputTest -Icstyle" 0003_FuncDeclVoid/FuncDeclVoid_Unbox23.k
run_test 55 62 cstyle "-MOutputTest -Icstyle" 0003_FuncDeclVoid/FuncDeclVoid_Unbox24.k
run_test 56 62 cstyle "-MOutputTest -Icstyle" 0003_FuncDeclVoid/FuncDeclVoid_Unbox25.k
run_test 57 62 cstyle "-MOutputTest -Icstyle" 0003_FuncDeclVoid/FuncDeclVoid_Unbox26.k
run_test 58 62 cstyle "-MOutputTest -Icstyle" 0003_FuncDeclVoid/FuncDeclVoid_Unbox27.k
run_test 59 62 cstyle "-MOutputTest -Icstyle" 0003_FuncDeclVoid/FuncDeclVoid_Unbox28.k
run_test 60 62 cstyle "-MOutputTest -Icstyle" 0003_FuncDeclVoid/FuncDeclVoid_Unbox29.k
run_test 61 62 cstyle "-MOutputTest -Icstyle" 0003_FuncDeclVoid/FuncDeclVoid_UnboxOverload30.k
run_test 62 62 cstyle "-MOutputTest -Icstyle" 0003_FuncDeclVoid/FuncDeclVoid_Void.k
record_result 0003_FuncDeclVoid $PASS 62
total

